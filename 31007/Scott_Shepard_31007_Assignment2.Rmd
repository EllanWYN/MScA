---
title: 'Week 2: Assignment'
author: "Scott Shepard"
date: "4/4/2018"
output:
  pdf_document: default
  html_document: default
subtitle: MScA, Statistical Analysis (31007)
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1 Generate uniformly distributed random numbers

## 1.1 Use runif()

Function runif(N,a,b) simulates N pseudo-random numbers uniformly distributed on [a,b].

```{r, 1.1}
set.seed(15)
Sample <- runif(1000, 0, 1)
```

## 1.2 Simulate Uniform Random Sample on [0,1] Using Random.org.

```{r, 1.2}
library(random)

nFlips <- 1000

dataFromRandom <- randomNumbers(n=nFlips, min=0, max=1, col=1, base=2, check=TRUE)
head(dataFromRandom)

```

## 1.4 Turning binary sequence to uniform random numbers

Turn your sequence of {0,1} into uniform random numbers on [0,1].

Create function that turns a sequence of zeros and ones of length n into decimal form.

```{r, 1.4.1}
bitsToInt <- function(x) {
    packBits(rev(c(rep(FALSE, 32-length(x)%%32), as.logical(x))), "integer")
}
bitsToInt(c(1,1,1,1,1,0))
```

Turn the sequence ofzeros and ones dataFromRandom of length 1000 into a matrix with 10 columns and 100 rows

```{r, 1.4.2}
Binary.matrix <- matrix(dataFromRandom,ncol=10)
head(Binary.matrix)
```

Transform each row of the matrix into decimal format using `bin2dec()` and divide the numbers by 2^10 to make real numbers in [0,1].

```{r, 1.4.3}
dataFromRandom.dec <- apply(Binary.matrix,1,bitsToInt)/2^10
head(dataFromRandom.dec)
```

# 2 Test random number generators

## 2.1 Test uniformity of distribution of both random number generators

### 2.1.1 Using Sample generated by runif()

Analyze what was simulated by first looking at the histogram.

```{r, 2.1.1-1}
Sample.histogram <- hist(Sample)
```

```{r, 2.1.1-2}
Sample.histogram
```

**What does the histogram tell you about the distribution? Is it consistent with the goal of simulation?**

Estimate mean and standard deviation of Sample.histogram$density.

```{r, 2.1.1-3}
(Sample.histogram.mean < -mean(Sample.histogram$density))
```

```{r, 2.1.1-4}
(Sample.histogram.sd<-sd(Sample.histogram$density))
```

```{r, 2.1.1-5}
plot(Sample.histogram,freq=FALSE,ylim=c(0,Sample.histogram.mean+2*Sample.histogram.sd))
abline(h=Sample.histogram.mean)
abline(h=Sample.histogram.mean+1.96*Sample.histogram.sd,col="red",lty=2)
abline(h=Sample.histogram.mean-1.96*Sample.histogram.sd,col="red",lty=2)
```

**What does the graph tell you about the observed distribution?**

Estimate moments of Sample.

```{r, 2.1.1-6}
(Sample.mean<-mean(Sample))
```

```{r, 2.1.1-7}
(Sample.variance<-var(Sample))
```

**What do you conclude about the estimated distribution from the moments?**

Check the summary of the simulated sample.

```{r, 2.1.1-8}
summary(Sample)
```

**What do you think is the best way of estimating uniform distribution over unknown interval?**

### 2.1.2 Repeat the same steps to test uniformity of the sample from Random.org

```{r, 2.1.2-1}
Sample.histogram<-hist(dataFromRandom.dec)
```

```{r, 2.1.2-2}
Sample.histogram
```

```{r, 2.1.2-3}
(Sample.histogram.mean<-mean(Sample.histogram$density))
```

```{r, 2.1.2-4}
(Sample.histogram.sd<-sd(Sample.histogram$density))
```

```{r, 2.1.2-5}
plot(Sample.histogram,freq=FALSE,ylim=c(0,Sample.histogram.mean+2*Sample.histogram.sd))
abline(h=Sample.histogram.mean)
abline(h=Sample.histogram.mean+1.96*Sample.histogram.sd,col="red",lty=2)
abline(h=Sample.histogram.mean-1.96*Sample.histogram.sd,col="red",lty=2)
```

```{r, 2.1.2-6}
(Sample.mean<-mean(dataFromRandom.dec))
```

```{r, 2.1.2-7}
(Sample.variance<-var(dataFromRandom.dec))
```

```{r, 2.1.2-8}
summary(dataFromRandom.dec)
```
